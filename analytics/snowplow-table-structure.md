---
layout: section
category: analytics
analytics_category: overview
title: Data structure
weight: 4
---

# SnowPlow table structure

SnowPlow data is stored in a single Apache Hive table. Each line in the table represents a single event, be that a page view, add-to-basket, video play etc.

The table structures for SnowPlow data in Hive and Infobright are almost identical. We'll cover the structure of the [Hive table](#hive-table-definition) before looking at the [Infobright table definition](#infobright) to see how it differs.

<a name="hive-table-definition"><h2>Hive table definitions</h2></a>

Understanding the SnowPlow table structure(s) in Hive is a pre-requisite to being able to write your own HiveQL queries.

The Hive table generated by **SnowPlowEventDeserializer** to hold SnowPlow-logged page views and events looks like this. (Note: in order to maintain backwards compatibility as we add new fields to the table, new fields are always added at the table end. As a result, they are not ordered as neatly as possible, from a readability perspective):

| **FIELD**            | **DATATYPE**   | **CAN BE EMPTY?** | **SINCE**  | **DESCRIPTION**            |
|:---------------------|:---------------|:------------------|:-----------|:---------------------------|
| **Date/time**        |                |                   |            | _The date and time of this page view or event_ |
| `dt`                 | STRING         | No                | -          | Date                       |
| `tm`                 | STRING         | No                | -          | Time                       |
| **Transaction**      |                |                   |            | _Identifying this logging event_ |
| `txn_id`             | STRING         | No                | -          | To deduplicate records in cases where two Cloudfront logs are generated from a single ping. |
| **User and visit**   |                |                   |            | _Identifying the web user and this specific visit_ |
| `user_id`            | STRING         | No                | -          | A unique ID assigned to each browser and stored on the SnowPlow cookie. |
| `user_ipaddress`     | STRING         | No                | -          | Visitor IP Address         |
| `visit_id`           | INT            | No                | -          | A counter that indicates what visit this is for this particular user_id i.e. 1 if this is a user's first visit, 2 if it is his / her 2nd visit |
| **Page**             |                |                   |            | _Identifying the web page being visited_ |
| `page_url`           | STRING         | No                | -          | The web page URL           |
| `page_title`         | STRING         | Yes               | -          | The web page title         |
| `page_referrer`      | STRING         | No                | -          | The referrer URL. If this is the first page view of a session, it points at the referrering website / search engine if applicable |
| **Marketing**        |                |                   |            | _Marketing campaign attribution_ |
| `mkt_source`         | STRING         | Yes               | -          | The source of the ad: used e.g. Google, MSN, Facebook, 
| `mkt_medium`         | STRING         | Yes               | -          | The type of ad used e.g. cpc, banner, email, affiliate... |
| `mkt_term`           | STRING         | Yes               | -          | Any keywords associated with the ad. This is relevant for search ads |
| `mkt_content`        | STRING         | Yes               | -          | The content of the ad, or a reference to the creative ID. Used e.g. to compare the results within a campaign between different creatives. |
| `mkt_campaign`       | STRING         | Yes               | -          | The campaign name. A single campaign may involve ads on multiple sources / mediums, so `mkt_campaign` is often a way of grouping them together into a single marketing initiative |
| **Event**            |                |                   |            | _If this is an event being logged, its details_ |
| `ev_category`        | STRING         | Yes               | -          | The category of event e.g. 'ecomm', 'media' |
| `ev_action`          | STRING         | Yes               | -          | The action performed e.g. 'play-video', 'add-to-basket' |
| `ev_label`           | STRING         | Yes               | -          | A label associated with the event / action. This is often set to the *object* and action is performed *on* e.g. the product_id of the item added-to-basket, or the ID of the video played |
| `ev_property`        | STRING         | Yes               | -          | A property associated with the event / action. This might be the number of seconds into a video play starts, or the quantity of an item added to basket |
| `ev_value`           | STRING         | Yes               | -          | A value associated with with the action e.g. the value of the items added to basket |
| **Transaction**      |                |                   |            | _If this is an ecommerce transaction being logged, its details_ |
| `tr_orderid`         | STRING         | Yes               | hive-0.4.9 | The ID of this order |
| `tr_affiliation`     | STRING         | Yes               | hive-0.4.9 | The affiliate or store name |
| `tr_total`           | STRING         | Yes               | hive-0.4.9 | The total paid |
| `tr_tax string`      | STRING         | Yes               | hive-0.4.9 | The tax paid |
| `tr_shipping`        | STRING         | Yes               | hive-0.4.9 | The shipping paid |
| `tr_city`            | STRING         | Yes               | hive-0.4.9 | The buyer's city |
| `tr_state`           | STRING         | Yes               | hive-0.4.9 | The buyer's state or province |
| `tr_country`         | STRING         | Yes               | hive-0.4.9 | The buyer's country |
| **Transaction item** |                |                   |            | _If this is a line item within an ecommerce transaction, its details_ |
| `ti_orderid`         | STRING         | Yes               | hive-0.4.9 | The ID of the order which this item belongs to |
| `ti_sku`             | STRING         | Yes               | hive-0.4.9 | The product SKU for this item |
| `ti_name`            | STRING         | Yes               | hive-0.4.9 | The product name for this item |
| `ti_category`        | STRING         | Yes               | hive-0.4.9 | The category this item belongs to |
| `ti_price`           | STRING         | Yes               | hive-0.4.9 | The unit price for this item |
| `ti_quantity`        | STRING         | Yes               | hive-0.4.9 | The quantity of this item purchased |
| **Browser**          |                |                   |            | _Information about the web browser_ |
| `br_name`            | STRING         | TBC               | -          | Browser name e.g. Internet Explorer |
| `br_family`          | STRING         | TBC               | -          | Browser family e.g. Chrome          |
| `br_version`         | STRING         | TBC               | -          | Browser version            |
| `br_type`            | STRING         | TBC               | -          | Type of client e.g. Browser, robot|
| `br_renderengine`    | STRING         | TBC               | -          | Browser rendering engine e.g. GECKO, WEBKIT |
| `br_lang`            | STRING         | No                | -          | Language that the browser is set to  |
| `br_features`        | ARRAY\[STRING\]| Yes               | -          | Contains a set of all features supported by this browser, e.g. `fla` for Flash, `pdf` for PDF support |
| `br_cookies`         | BOOLEAN        | No                | -          | Flag set to 'true' if browser permits cookies |
| **Operating system** |                |                   |            | _Information about the host operating system_ |
| `os_name`            | STRING         | TBC               | -          | Operating system name e.g. Windows            |
| `os_family`          | STRING         | TBC               | -          | Operating system family e.g. Android          |
| `os_manufacturer`    | STRING         | TBC               | -          | Operating system manufacturer e.g. Apple Inc., Google Inc.  |
| **Device/hardware**  |                |                   |            | _Information about the host device/hardware_ |
| `dvce_type`          | STRING         | TBC               | -          | Device type e.g. computer, mobile...         |
| `dvce_ismobile`      | BOOLEAN        | TBC               | -          | Flag set if user is browsing on a mobile device  |
| `dvce_screenwidth`   | INT            | No                | -          | Screenwidth in pixels      |
| `dvce_screenheight`  | INT            | No                | -          | Screenheight in pixels     |
| **Application**      |                |                   |            | _The application or site which this event belongs to_ |
| `app_id`             | STRING         | Yes               | hive-0.4.9 | The ID for the application or site |
| `platform_id`        | STRING         | Yes               | hive-0.5.1 |          |
| **Later additions**  |                |                   |            | _The following fields were added more recently, which is why they are not grouped with related fields above_ |
| `event`              | STRING         | Yes               | hive-0.5.1 |          |
| `v_tracker`          | STRING         | Yes               | hive-0.5.1 |          |
| `v_collector`        | STRING         | Yes               | hive-0.5.1 |          |
| `v_etl`              | STRING         | Yes               | hive-0.5.1 |          |
| `event_id`           | STRING         | Yes               | hive-0.5.1 |          |
| `user_fingerprint`   | STRING         | No                | hive-0.5.1 |          |
| `useragent`          | STRING         | No                | hive-0.5.1 |          |
| `br_colordepth`      | STRING         | No                | hive-0.5.1 |          |
| `os_timezone`        | STRING         | No                | hive-0.5.1 |          |



<a name="infobright"><h2>Infobright table definitions</h2></a>


The Infobright table definition is very similar to the Hive table definition. Three differences are worth noting:

1. The data types for a number of fields are different. Hive is very good at casting e.g. STRINGs as FLOATs implicitly where possibly and explicitly where required at query time. Infobright is less good, so some of the fields that are set to STRING in Hive (e.g. ev_value) are set to numeric types in Infobright.
2. Infobright does not support the ARRAY data type used for the `br_features` field. Rather than pack all the different browser features in a single array, then, a separate column is used to store each possible browser feature.
3. Because Infobright does not handle the addition of columns to existing tables gracefully, every time we add a column we have to create a new table and migrate data from the old table. As a result, all the fields are more tidily organised (grouped together thematically) that is the case with the Hive table, where the order reflects, with later fields, when those fields were added to the table.

The Infobright table looks like this:

| **FIELD**                | **DATATYPE**  |
|:-------------------------|:--------------|
| app_id                   | varchar(255)  | 
| platform                 | varchar(50)   | 
| dt                       | date          | 
| tm                       | time          | 
| event                    | varchar(255)  | 
| event_id                 | varchar(38)   | 
| txn_id                   | int(11)       | 
| v_tracker                | varchar(100)  | 
| v_collector              | varchar(100)  | 
| v_etl                    | varchar(100)  | 
| user_id                  | varchar(16)   | 
| user_ipaddress           | varchar(19)   | 
| user_fingerprint         | varchar(50)   | 
| visit_id                 | smallint(6)   | 
| page_url                 | varchar(4095) | 
| page_title               | varchar(2083) | 
| page_referrer            | varchar(2083) | 
| mkt_source               | varchar(255)  | 
| mkt_medium               | varchar(255)  | 
| mkt_term                 | varchar(255)  | 
| mkt_content              | varchar(2083) | 
| mkt_campaign             | varchar(255)  | 
| ev_category              | varchar(255)  | 
| ev_action                | varchar(255)  | 
| ev_label                 | varchar(255)  | 
| ev_property              | varchar(255)  | 
| ev_value                 | float         | 
| tr_orderid               | varchar(255)  | 
| tr_affiliation           | varchar(255)  | 
| tr_total                 | decimal(18,2) | 
| tr_tax                   | decimal(18,2) | 
| tr_shipping              | decimal(18,2) | 
| tr_city                  | varchar(255)  | 
| tr_state                 | varchar(255)  | 
| tr_country               | varchar(255)  | 
| ti_orderid               | varchar(255)  | 
| ti_sku                   | varchar(255)  | 
| ti_name                  | varchar(255)  | 
| ti_category              | varchar(255)  | 
| ti_price                 | decimal(18,2) | 
| ti_quantity              | int(11)       | 
| useragent                | varchar(2083) | 
| br_name                  | varchar(50)   | 
| br_family                | varchar(50)   | 
| br_version               | varchar(50)   | 
| br_type                  | varchar(50)   | 
| br_renderengine          | varchar(50)   | 
| br_lang                  | varchar(255)  | 
| br_features_pdf          | tinyint(1)    | 
| br_features_flash        | tinyint(1)    | 
| br_features_java         | tinyint(1)    | 
| br_features_director     | tinyint(1)    | 
| br_features_quicktime    | tinyint(1)    | 
| br_features_realplayer   | tinyint(1)    | 
| br_features_windowsmedia | tinyint(1)    | 
| br_features_gears        | tinyint(1)    | 
| br_features_silverlight  | tinyint(1)    | 
| br_cookies               | tinyint(1)    | 
| br_colordepth            | varchar(12)   | 
| os_name                  | varchar(50)   | 
| os_family                | varchar(50)   | 
| os_manufacturer          | varchar(50)   | 
| os_timezone              | varchar(255)  | 
| dvce_type                | varchar(50)   | 
| dvce_ismobile            | tinyint(1)    | 
| dvce_screenwidth         | mediumint(9)  | 
| dvce_screenheight        | mediumint(9)  | 


## Next steps

Happy with the SnowPlow events data structure? Then [dive into some analysis] [basic-recipes].

[basic-recipes]: basic-recipes.html